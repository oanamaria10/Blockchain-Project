{"ast":null,"code":"import * as UploadCapabilities from '@web3-storage/capabilities/upload';\nimport { SpaceDID } from '@web3-storage/capabilities/utils';\nimport { servicePrincipal, connection } from '../service.js';\n/**\n * List uploads created by the issuer.\n *\n * @param {import('../types.js').InvocationConfig} conf Configuration\n * for the UCAN invocation. An object with `issuer`, `with` and `proofs`.\n *\n * The `issuer` is the signing authority that is issuing the UCAN\n * invocation(s). It is typically the user _agent_.\n *\n * The `with` is the resource the invocation applies to. It is typically the\n * DID of a space.\n *\n * The `proofs` are a set of capability delegations that prove the issuer\n * has the capability to perform the action.\n *\n * The issuer needs the `upload/list` delegated capability.\n * @param {import('../types.js').ListRequestOptions} [options]\n * @returns {Promise<import('../types.js').UploadListSuccess>}\n */\nexport async function list({\n  issuer,\n  with: resource,\n  proofs,\n  audience\n}, options = {}) {\n  /* c8 ignore next */\n  const conn = options.connection ?? connection;\n  const result = await UploadCapabilities.list.invoke({\n    issuer,\n    /* c8 ignore next */\n    audience: audience ?? servicePrincipal,\n    with: SpaceDID.from(resource),\n    proofs,\n    nb: input(options.cursor, options.size, options.pre),\n    nonce: options.nonce\n  }).execute(conn);\n  if (!result.out.ok) {\n    throw new Error(`failed ${UploadCapabilities.list.can} invocation`, {\n      cause: result.out.error\n    });\n  }\n  return result.out.ok;\n}\n/** Returns the ability used by an invocation. */\nexport const ability = UploadCapabilities.list.can;\n/**\n * Returns required input to the invocation.\n *\n * @param {string} [cursor]\n * @param {number} [size]\n * @param {boolean} [pre]\n */\nexport const input = (cursor, size, pre) => ({\n  cursor,\n  size,\n  pre\n});","map":{"version":3,"names":["UploadCapabilities","SpaceDID","servicePrincipal","connection","list","issuer","with","resource","proofs","audience","options","conn","result","invoke","from","nb","input","cursor","size","pre","nonce","execute","out","ok","Error","can","cause","error","ability"],"sources":["../../../src/upload/list.js"],"sourcesContent":[null],"mappings":"AAAA,OAAO,KAAKA,kBAAkB,MAAM,mCAAmC;AACvE,SAASC,QAAQ,QAAQ,kCAAkC;AAC3D,SAASC,gBAAgB,EAAEC,UAAU,QAAQ,eAAe;AAE5D;;;;;;;;;;;;;;;;;;;AAmBA,OAAO,eAAeC,IAAIA,CACxB;EAAEC,MAAM;EAAEC,IAAI,EAAEC,QAAQ;EAAEC,MAAM;EAAEC;AAAQ,CAAE,EAC5CC,OAAO,GAAG,EAAE;EAEZ;EACA,MAAMC,IAAI,GAAGD,OAAO,CAACP,UAAU,IAAIA,UAAU;EAE7C,MAAMS,MAAM,GAAG,MAAMZ,kBAAkB,CAACI,IAAI,CACzCS,MAAM,CAAC;IACNR,MAAM;IACN;IACAI,QAAQ,EAAEA,QAAQ,IAAIP,gBAAgB;IACtCI,IAAI,EAAEL,QAAQ,CAACa,IAAI,CAACP,QAAQ,CAAC;IAC7BC,MAAM;IACNO,EAAE,EAAEC,KAAK,CAACN,OAAO,CAACO,MAAM,EAAEP,OAAO,CAACQ,IAAI,EAAER,OAAO,CAACS,GAAG,CAAC;IACpDC,KAAK,EAAEV,OAAO,CAACU;GAChB,CAAC,CACDC,OAAO,CAACV,IAAI,CAAC;EAEhB,IAAI,CAACC,MAAM,CAACU,GAAG,CAACC,EAAE,EAAE;IAClB,MAAM,IAAIC,KAAK,CAAC,UAAUxB,kBAAkB,CAACI,IAAI,CAACqB,GAAG,aAAa,EAAE;MAClEC,KAAK,EAAEd,MAAM,CAACU,GAAG,CAACK;KACnB,CAAC;;EAGJ,OAAOf,MAAM,CAACU,GAAG,CAACC,EAAE;AACtB;AAEA;AACA,OAAO,MAAMK,OAAO,GAAG5B,kBAAkB,CAACI,IAAI,CAACqB,GAAG;AAElD;;;;;;;AAOA,OAAO,MAAMT,KAAK,GAAGA,CAACC,MAAM,EAAEC,IAAI,EAAEC,GAAG,MAAM;EAAEF,MAAM;EAAEC,IAAI;EAAEC;AAAG,CAAE,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}