{"ast":null,"code":"import * as API from '@ucanto/interface';\nimport * as CBOR from '@ucanto/core/cbor';\nexport const contentType = 'application/cbor';\nconst HEADERS = Object.freeze({\n  'content-type': contentType\n});\n\n/**\n * Encodes `AgentMessage` into a legacy CBOR representation.\n *\n * @template {API.AgentMessage} Message\n * @param {Message} message\n * @param {API.EncodeOptions} [options]\n * @returns {API.HTTPResponse<Message>}\n */\nexport const encode = (message, options) => {\n  const legacyResults = [];\n  for (const receipt of message.receipts.values()) {\n    const result = receipt.out;\n    if (result.ok) {\n      legacyResults.push(result.ok);\n    } else {\n      legacyResults.push({\n        ...result.error,\n        error: true\n      });\n    }\n  }\n\n  /** @type {Uint8Array} */\n  const body = CBOR.encode(legacyResults);\n  return /** @type {API.HTTPResponse<Message>} */{\n    headers: HEADERS,\n    body\n  };\n};","map":{"version":3,"names":["API","CBOR","contentType","HEADERS","Object","freeze","encode","message","options","legacyResults","receipt","receipts","values","result","out","ok","push","error","body","headers"],"sources":["C:/FACULTATE/Proiect/node_modules/@ucanto/transport/src/legacy/response.js"],"sourcesContent":["import * as API from '@ucanto/interface'\nimport * as CBOR from '@ucanto/core/cbor'\nexport const contentType = 'application/cbor'\n\nconst HEADERS = Object.freeze({\n  'content-type': contentType,\n})\n\n/**\n * Encodes `AgentMessage` into a legacy CBOR representation.\n *\n * @template {API.AgentMessage} Message\n * @param {Message} message\n * @param {API.EncodeOptions} [options]\n * @returns {API.HTTPResponse<Message>}\n */\nexport const encode = (message, options) => {\n  const legacyResults = []\n  for (const receipt of message.receipts.values()) {\n    const result = receipt.out\n    if (result.ok) {\n      legacyResults.push(result.ok)\n    } else {\n      legacyResults.push({\n        ...result.error,\n        error: true,\n      })\n    }\n  }\n\n  /** @type {Uint8Array} */\n  const body = CBOR.encode(legacyResults)\n\n  return /** @type {API.HTTPResponse<Message>} */ ({\n    headers: HEADERS,\n    body,\n  })\n}\n"],"mappings":"AAAA,OAAO,KAAKA,GAAG,MAAM,mBAAmB;AACxC,OAAO,KAAKC,IAAI,MAAM,mBAAmB;AACzC,OAAO,MAAMC,WAAW,GAAG,kBAAkB;AAE7C,MAAMC,OAAO,GAAGC,MAAM,CAACC,MAAM,CAAC;EAC5B,cAAc,EAAEH;AAClB,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMI,MAAM,GAAGA,CAACC,OAAO,EAAEC,OAAO,KAAK;EAC1C,MAAMC,aAAa,GAAG,EAAE;EACxB,KAAK,MAAMC,OAAO,IAAIH,OAAO,CAACI,QAAQ,CAACC,MAAM,CAAC,CAAC,EAAE;IAC/C,MAAMC,MAAM,GAAGH,OAAO,CAACI,GAAG;IAC1B,IAAID,MAAM,CAACE,EAAE,EAAE;MACbN,aAAa,CAACO,IAAI,CAACH,MAAM,CAACE,EAAE,CAAC;IAC/B,CAAC,MAAM;MACLN,aAAa,CAACO,IAAI,CAAC;QACjB,GAAGH,MAAM,CAACI,KAAK;QACfA,KAAK,EAAE;MACT,CAAC,CAAC;IACJ;EACF;;EAEA;EACA,MAAMC,IAAI,GAAGjB,IAAI,CAACK,MAAM,CAACG,aAAa,CAAC;EAEvC,OAAO,wCAA0C;IAC/CU,OAAO,EAAEhB,OAAO;IAChBe;EACF,CAAC;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}