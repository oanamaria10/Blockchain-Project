{"ast":null,"code":"import { DID, Schema, capability, ok, struct } from '@ucanto/validator';\nimport { AccountDID, equal, equalWith, and } from './utils.js';\n\n/**\n * Capability can be invoked by an account to get information about\n * the plan it is currently signed up for.\n */\nexport const get = capability({\n  can: 'plan/get',\n  with: AccountDID,\n  derives: (child, parent) => {\n    return and(equalWith(child, parent)) || ok({});\n  }\n});\n\n/**\n * Capability can be invoked by an account to change its billing plan.\n */\nexport const set = capability({\n  can: 'plan/set',\n  with: AccountDID,\n  nb: struct({\n    product: DID\n  }),\n  derives: (child, parent) => {\n    return and(equalWith(child, parent)) || and(equal(child.nb.product, parent.nb.product, 'product')) || ok({});\n  }\n});\n\n/**\n * Capability can be invoked by an account to generate a billing admin session.\n *\n * May not be possible with all billing providers - this is designed with\n * https://docs.stripe.com/api/customer_portal/sessions/create in mind.\n */\nexport const createAdminSession = capability({\n  can: 'plan/create-admin-session',\n  with: AccountDID,\n  nb: struct({\n    returnURL: Schema.string()\n  }),\n  derives: (child, parent) => {\n    return and(equalWith(child, parent)) || and(equal(child.nb.returnURL, parent.nb.returnURL, 'returnURL')) || ok({});\n  }\n});","map":{"version":3,"names":["DID","Schema","capability","ok","struct","AccountDID","equal","equalWith","and","get","can","with","derives","child","parent","set","nb","product","createAdminSession","returnURL","string"],"sources":["C:/FACULTATE/Proiect/node_modules/@web3-storage/capabilities/src/plan.js"],"sourcesContent":["import { DID, Schema, capability, ok, struct } from '@ucanto/validator'\nimport { AccountDID, equal, equalWith, and } from './utils.js'\n\n/**\n * Capability can be invoked by an account to get information about\n * the plan it is currently signed up for.\n */\nexport const get = capability({\n  can: 'plan/get',\n  with: AccountDID,\n  derives: (child, parent) => {\n    return and(equalWith(child, parent)) || ok({})\n  },\n})\n\n/**\n * Capability can be invoked by an account to change its billing plan.\n */\nexport const set = capability({\n  can: 'plan/set',\n  with: AccountDID,\n  nb: struct({\n    product: DID,\n  }),\n  derives: (child, parent) => {\n    return (\n      and(equalWith(child, parent)) ||\n      and(equal(child.nb.product, parent.nb.product, 'product')) ||\n      ok({})\n    )\n  },\n})\n\n/**\n * Capability can be invoked by an account to generate a billing admin session.\n *\n * May not be possible with all billing providers - this is designed with\n * https://docs.stripe.com/api/customer_portal/sessions/create in mind.\n */\nexport const createAdminSession = capability({\n  can: 'plan/create-admin-session',\n  with: AccountDID,\n  nb: struct({\n    returnURL: Schema.string(),\n  }),\n  derives: (child, parent) => {\n    return (\n      and(equalWith(child, parent)) ||\n      and(equal(child.nb.returnURL, parent.nb.returnURL, 'returnURL')) ||\n      ok({})\n    )\n  },\n})\n"],"mappings":"AAAA,SAASA,GAAG,EAAEC,MAAM,EAAEC,UAAU,EAAEC,EAAE,EAAEC,MAAM,QAAQ,mBAAmB;AACvE,SAASC,UAAU,EAAEC,KAAK,EAAEC,SAAS,EAAEC,GAAG,QAAQ,YAAY;;AAE9D;AACA;AACA;AACA;AACA,OAAO,MAAMC,GAAG,GAAGP,UAAU,CAAC;EAC5BQ,GAAG,EAAE,UAAU;EACfC,IAAI,EAAEN,UAAU;EAChBO,OAAO,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;IAC1B,OAAON,GAAG,CAACD,SAAS,CAACM,KAAK,EAAEC,MAAM,CAAC,CAAC,IAAIX,EAAE,CAAC,CAAC,CAAC,CAAC;EAChD;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA,OAAO,MAAMY,GAAG,GAAGb,UAAU,CAAC;EAC5BQ,GAAG,EAAE,UAAU;EACfC,IAAI,EAAEN,UAAU;EAChBW,EAAE,EAAEZ,MAAM,CAAC;IACTa,OAAO,EAAEjB;EACX,CAAC,CAAC;EACFY,OAAO,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;IAC1B,OACEN,GAAG,CAACD,SAAS,CAACM,KAAK,EAAEC,MAAM,CAAC,CAAC,IAC7BN,GAAG,CAACF,KAAK,CAACO,KAAK,CAACG,EAAE,CAACC,OAAO,EAAEH,MAAM,CAACE,EAAE,CAACC,OAAO,EAAE,SAAS,CAAC,CAAC,IAC1Dd,EAAE,CAAC,CAAC,CAAC,CAAC;EAEV;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMe,kBAAkB,GAAGhB,UAAU,CAAC;EAC3CQ,GAAG,EAAE,2BAA2B;EAChCC,IAAI,EAAEN,UAAU;EAChBW,EAAE,EAAEZ,MAAM,CAAC;IACTe,SAAS,EAAElB,MAAM,CAACmB,MAAM,CAAC;EAC3B,CAAC,CAAC;EACFR,OAAO,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;IAC1B,OACEN,GAAG,CAACD,SAAS,CAACM,KAAK,EAAEC,MAAM,CAAC,CAAC,IAC7BN,GAAG,CAACF,KAAK,CAACO,KAAK,CAACG,EAAE,CAACG,SAAS,EAAEL,MAAM,CAACE,EAAE,CAACG,SAAS,EAAE,WAAW,CAAC,CAAC,IAChEhB,EAAE,CAAC,CAAC,CAAC,CAAC;EAEV;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}