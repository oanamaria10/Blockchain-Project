{"ast":null,"code":"import { __assign } from \"tslib\";\n/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { captureException, getCurrentHub, startTransaction, withScope } from '@sentry/core';\nimport { extractTraceparentData } from '@sentry/tracing';\nimport { extractNodeRequestData, forget, isPlainObject, isString, logger, stripUrlQueryAndFragment } from '@sentry/utils';\nimport * as domain from 'domain';\nimport * as os from 'os';\nimport { flush } from './sdk';\nvar DEFAULT_SHUTDOWN_TIMEOUT = 2000;\n/**\n * Express-compatible tracing handler.\n * @see Exposed as `Handlers.tracingHandler`\n */\nexport function tracingHandler() {\n  return function sentryTracingMiddleware(req, res, next) {\n    // If there is a trace header set, we extract the data from it (parentSpanId, traceId, and sampling decision)\n    var traceparentData;\n    if (req.headers && isString(req.headers['sentry-trace'])) {\n      traceparentData = extractTraceparentData(req.headers['sentry-trace']);\n    }\n    var transaction = startTransaction(__assign({\n      name: extractExpressTransactionName(req, {\n        path: true,\n        method: true\n      }),\n      op: 'http.server'\n    }, traceparentData));\n    // We put the transaction on the scope so users can attach children to it\n    getCurrentHub().configureScope(function (scope) {\n      scope.setSpan(transaction);\n    });\n    // We also set __sentry_transaction on the response so people can grab the transaction there to add\n    // spans to it later.\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    res.__sentry_transaction = transaction;\n    res.once('finish', function () {\n      // Push `transaction.finish` to the next event loop so open spans have a chance to finish before the transaction\n      // closes\n      setImmediate(function () {\n        addExpressReqToTransaction(transaction, req);\n        transaction.setHttpStatus(res.statusCode);\n        transaction.finish();\n      });\n    });\n    next();\n  };\n}\n/**\n * Set parameterized as transaction name e.g.: `GET /users/:id`\n * Also adds more context data on the transaction from the request\n */\nfunction addExpressReqToTransaction(transaction, req) {\n  if (!transaction) return;\n  transaction.name = extractExpressTransactionName(req, {\n    path: true,\n    method: true\n  });\n  transaction.setData('url', req.originalUrl);\n  transaction.setData('baseUrl', req.baseUrl);\n  transaction.setData('query', req.query);\n}\n/**\n * Extracts complete generalized path from the request object and uses it to construct transaction name.\n *\n * eg. GET /mountpoint/user/:id\n *\n * @param req The ExpressRequest object\n * @param options What to include in the transaction name (method, path, or both)\n *\n * @returns The fully constructed transaction name\n */\nfunction extractExpressTransactionName(req, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  var _a;\n  var method = (_a = req.method) === null || _a === void 0 ? void 0 : _a.toUpperCase();\n  var path = '';\n  if (req.route) {\n    // if the mountpoint is `/`, req.baseUrl is '' (not undefined), so it's safe to include it here\n    // see https://github.com/expressjs/express/blob/508936853a6e311099c9985d4c11a4b1b8f6af07/test/req.baseUrl.js#L7\n    path = \"\" + req.baseUrl + req.route.path;\n  } else if (req.originalUrl || req.url) {\n    path = stripUrlQueryAndFragment(req.originalUrl || req.url || '');\n  }\n  var info = '';\n  if (options.method && method) {\n    info += method;\n  }\n  if (options.method && options.path) {\n    info += \" \";\n  }\n  if (options.path && path) {\n    info += path;\n  }\n  return info;\n}\n/** JSDoc */\nfunction extractTransaction(req, type) {\n  var _a;\n  switch (type) {\n    case 'path':\n      {\n        return extractExpressTransactionName(req, {\n          path: true\n        });\n      }\n    case 'handler':\n      {\n        return ((_a = req.route) === null || _a === void 0 ? void 0 : _a.stack[0].name) || '<anonymous>';\n      }\n    case 'methodPath':\n    default:\n      {\n        return extractExpressTransactionName(req, {\n          path: true,\n          method: true\n        });\n      }\n  }\n}\n/** Default user keys that'll be used to extract data from the request */\nvar DEFAULT_USER_KEYS = ['id', 'username', 'email'];\n/** JSDoc */\nfunction extractUserData(user, keys) {\n  var extractedUser = {};\n  var attributes = Array.isArray(keys) ? keys : DEFAULT_USER_KEYS;\n  attributes.forEach(function (key) {\n    if (user && key in user) {\n      extractedUser[key] = user[key];\n    }\n  });\n  return extractedUser;\n}\n/**\n * Enriches passed event with request data.\n *\n * @param event Will be mutated and enriched with req data\n * @param req Request object\n * @param options object containing flags to enable functionality\n * @hidden\n */\nexport function parseRequest(event, req, options) {\n  // eslint-disable-next-line no-param-reassign\n  options = __assign({\n    ip: false,\n    request: true,\n    serverName: true,\n    transaction: true,\n    user: true,\n    version: true\n  }, options);\n  if (options.version) {\n    event.contexts = __assign(__assign({}, event.contexts), {\n      runtime: {\n        name: 'node',\n        version: global.process.version\n      }\n    });\n  }\n  if (options.request) {\n    // if the option value is `true`, use the default set of keys by not passing anything to `extractNodeRequestData()`\n    var extractedRequestData = Array.isArray(options.request) ? extractNodeRequestData(req, options.request) : extractNodeRequestData(req);\n    event.request = __assign(__assign({}, event.request), extractedRequestData);\n  }\n  if (options.serverName && !event.server_name) {\n    event.server_name = global.process.env.SENTRY_NAME || os.hostname();\n  }\n  if (options.user) {\n    var extractedUser = req.user && isPlainObject(req.user) ? extractUserData(req.user, options.user) : {};\n    if (Object.keys(extractedUser)) {\n      event.user = __assign(__assign({}, event.user), extractedUser);\n    }\n  }\n  // client ip:\n  //   node: req.connection.remoteAddress\n  //   express, koa: req.ip\n  if (options.ip) {\n    var ip = req.ip || req.connection && req.connection.remoteAddress;\n    if (ip) {\n      event.user = __assign(__assign({}, event.user), {\n        ip_address: ip\n      });\n    }\n  }\n  if (options.transaction && !event.transaction) {\n    event.transaction = extractTransaction(req, options.transaction);\n  }\n  return event;\n}\n/**\n * Express compatible request handler.\n * @see Exposed as `Handlers.requestHandler`\n */\nexport function requestHandler(options) {\n  return function sentryRequestMiddleware(req, res, next) {\n    if (options && options.flushTimeout && options.flushTimeout > 0) {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      var _end_1 = res.end;\n      res.end = function (chunk, encoding, cb) {\n        var _this = this;\n        flush(options.flushTimeout).then(function () {\n          _end_1.call(_this, chunk, encoding, cb);\n        }).then(null, function (e) {\n          logger.error(e);\n        });\n      };\n    }\n    var local = domain.create();\n    local.add(req);\n    local.add(res);\n    local.on('error', next);\n    local.run(function () {\n      getCurrentHub().configureScope(function (scope) {\n        return scope.addEventProcessor(function (event) {\n          return parseRequest(event, req, options);\n        });\n      });\n      next();\n    });\n  };\n}\n/** JSDoc */\nfunction getStatusCodeFromResponse(error) {\n  var statusCode = error.status || error.statusCode || error.status_code || error.output && error.output.statusCode;\n  return statusCode ? parseInt(statusCode, 10) : 500;\n}\n/** Returns true if response code is internal server error */\nfunction defaultShouldHandleError(error) {\n  var status = getStatusCodeFromResponse(error);\n  return status >= 500;\n}\n/**\n * Express compatible error handler.\n * @see Exposed as `Handlers.errorHandler`\n */\nexport function errorHandler(options) {\n  return function sentryErrorMiddleware(error, _req, res, next) {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    var shouldHandleError = options && options.shouldHandleError || defaultShouldHandleError;\n    if (shouldHandleError(error)) {\n      withScope(function (_scope) {\n        // For some reason we need to set the transaction on the scope again\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        var transaction = res.__sentry_transaction;\n        if (transaction && _scope.getSpan() === undefined) {\n          _scope.setSpan(transaction);\n        }\n        var eventId = captureException(error);\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        res.sentry = eventId;\n        next(error);\n      });\n      return;\n    }\n    next(error);\n  };\n}\n/**\n * @hidden\n */\nexport function logAndExitProcess(error) {\n  // eslint-disable-next-line no-console\n  console.error(error && error.stack ? error.stack : error);\n  var client = getCurrentHub().getClient();\n  if (client === undefined) {\n    logger.warn('No NodeClient was defined, we are exiting the process now.');\n    global.process.exit(1);\n    return;\n  }\n  var options = client.getOptions();\n  var timeout = options && options.shutdownTimeout && options.shutdownTimeout > 0 && options.shutdownTimeout || DEFAULT_SHUTDOWN_TIMEOUT;\n  forget(client.close(timeout).then(function (result) {\n    if (!result) {\n      logger.warn('We reached the timeout for emptying the request buffer, still exiting now!');\n    }\n    global.process.exit(1);\n  }));\n}","map":{"version":3,"names":["captureException","getCurrentHub","startTransaction","withScope","extractTraceparentData","extractNodeRequestData","forget","isPlainObject","isString","logger","stripUrlQueryAndFragment","domain","os","flush","DEFAULT_SHUTDOWN_TIMEOUT","tracingHandler","sentryTracingMiddleware","req","res","next","traceparentData","headers","transaction","__assign","name","extractExpressTransactionName","path","method","op","configureScope","scope","setSpan","__sentry_transaction","once","setImmediate","addExpressReqToTransaction","setHttpStatus","statusCode","finish","setData","originalUrl","baseUrl","query","options","_a","toUpperCase","route","url","info","extractTransaction","type","stack","DEFAULT_USER_KEYS","extractUserData","user","keys","extractedUser","attributes","Array","isArray","forEach","key","parseRequest","event","ip","request","serverName","version","contexts","runtime","global","process","extractedRequestData","server_name","env","SENTRY_NAME","hostname","Object","connection","remoteAddress","ip_address","requestHandler","sentryRequestMiddleware","flushTimeout","_end_1","end","chunk","encoding","cb","_this","then","call","e","error","local","create","add","on","run","addEventProcessor","getStatusCodeFromResponse","status","status_code","output","parseInt","defaultShouldHandleError","errorHandler","sentryErrorMiddleware","_req","shouldHandleError","_scope","getSpan","undefined","eventId","sentry","logAndExitProcess","console","client","getClient","warn","exit","getOptions","timeout","shutdownTimeout","close","result"],"sources":["C:\\Users\\rares\\Desktop\\Blockchain\\Proiect\\node_modules\\@sentry\\node\\src\\handlers.ts"],"sourcesContent":["/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { captureException, getCurrentHub, startTransaction, withScope } from '@sentry/core';\nimport { extractTraceparentData, Span } from '@sentry/tracing';\nimport { Event, Transaction } from '@sentry/types';\nimport {\n  extractNodeRequestData,\n  forget,\n  isPlainObject,\n  isString,\n  logger,\n  stripUrlQueryAndFragment,\n} from '@sentry/utils';\nimport * as domain from 'domain';\nimport * as http from 'http';\nimport * as os from 'os';\n\nimport { NodeClient } from './client';\nimport { flush } from './sdk';\n\nconst DEFAULT_SHUTDOWN_TIMEOUT = 2000;\n\nexport interface ExpressRequest extends http.IncomingMessage {\n  [key: string]: any;\n  baseUrl?: string;\n  ip?: string;\n  originalUrl?: string;\n  route?: {\n    path: string;\n    stack: [\n      {\n        name: string;\n      },\n    ];\n  };\n  user?: {\n    [key: string]: any;\n  };\n}\n\n/**\n * Express-compatible tracing handler.\n * @see Exposed as `Handlers.tracingHandler`\n */\nexport function tracingHandler(): (\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (error?: any) => void,\n) => void {\n  return function sentryTracingMiddleware(\n    req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error?: any) => void,\n  ): void {\n    // If there is a trace header set, we extract the data from it (parentSpanId, traceId, and sampling decision)\n    let traceparentData;\n    if (req.headers && isString(req.headers['sentry-trace'])) {\n      traceparentData = extractTraceparentData(req.headers['sentry-trace'] as string);\n    }\n\n    const transaction = startTransaction({\n      name: extractExpressTransactionName(req, { path: true, method: true }),\n      op: 'http.server',\n      ...traceparentData,\n    });\n\n    // We put the transaction on the scope so users can attach children to it\n    getCurrentHub().configureScope(scope => {\n      scope.setSpan(transaction);\n    });\n\n    // We also set __sentry_transaction on the response so people can grab the transaction there to add\n    // spans to it later.\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    (res as any).__sentry_transaction = transaction;\n\n    res.once('finish', () => {\n      // Push `transaction.finish` to the next event loop so open spans have a chance to finish before the transaction\n      // closes\n      setImmediate(() => {\n        addExpressReqToTransaction(transaction, req);\n        transaction.setHttpStatus(res.statusCode);\n        transaction.finish();\n      });\n    });\n\n    next();\n  };\n}\n\n/**\n * Set parameterized as transaction name e.g.: `GET /users/:id`\n * Also adds more context data on the transaction from the request\n */\nfunction addExpressReqToTransaction(transaction: Transaction | undefined, req: ExpressRequest): void {\n  if (!transaction) return;\n  transaction.name = extractExpressTransactionName(req, { path: true, method: true });\n  transaction.setData('url', req.originalUrl);\n  transaction.setData('baseUrl', req.baseUrl);\n  transaction.setData('query', req.query);\n}\n\n/**\n * Extracts complete generalized path from the request object and uses it to construct transaction name.\n *\n * eg. GET /mountpoint/user/:id\n *\n * @param req The ExpressRequest object\n * @param options What to include in the transaction name (method, path, or both)\n *\n * @returns The fully constructed transaction name\n */\nfunction extractExpressTransactionName(\n  req: ExpressRequest,\n  options: { path?: boolean; method?: boolean } = {},\n): string {\n  const method = req.method?.toUpperCase();\n\n  let path = '';\n  if (req.route) {\n    // if the mountpoint is `/`, req.baseUrl is '' (not undefined), so it's safe to include it here\n    // see https://github.com/expressjs/express/blob/508936853a6e311099c9985d4c11a4b1b8f6af07/test/req.baseUrl.js#L7\n    path = `${req.baseUrl}${req.route.path}`;\n  } else if (req.originalUrl || req.url) {\n    path = stripUrlQueryAndFragment(req.originalUrl || req.url || '');\n  }\n\n  let info = '';\n  if (options.method && method) {\n    info += method;\n  }\n  if (options.method && options.path) {\n    info += ` `;\n  }\n  if (options.path && path) {\n    info += path;\n  }\n\n  return info;\n}\n\ntype TransactionNamingScheme = 'path' | 'methodPath' | 'handler';\n\n/** JSDoc */\nfunction extractTransaction(req: ExpressRequest, type: boolean | TransactionNamingScheme): string {\n  switch (type) {\n    case 'path': {\n      return extractExpressTransactionName(req, { path: true });\n    }\n    case 'handler': {\n      return req.route?.stack[0].name || '<anonymous>';\n    }\n    case 'methodPath':\n    default: {\n      return extractExpressTransactionName(req, { path: true, method: true });\n    }\n  }\n}\n\n/** Default user keys that'll be used to extract data from the request */\nconst DEFAULT_USER_KEYS = ['id', 'username', 'email'];\n\n/** JSDoc */\nfunction extractUserData(\n  user: {\n    [key: string]: any;\n  },\n  keys: boolean | string[],\n): { [key: string]: any } {\n  const extractedUser: { [key: string]: any } = {};\n  const attributes = Array.isArray(keys) ? keys : DEFAULT_USER_KEYS;\n\n  attributes.forEach(key => {\n    if (user && key in user) {\n      extractedUser[key] = user[key];\n    }\n  });\n\n  return extractedUser;\n}\n\n/**\n * Options deciding what parts of the request to use when enhancing an event\n */\nexport interface ParseRequestOptions {\n  ip?: boolean;\n  request?: boolean | string[];\n  serverName?: boolean;\n  transaction?: boolean | TransactionNamingScheme;\n  user?: boolean | string[];\n  version?: boolean;\n}\n\n/**\n * Enriches passed event with request data.\n *\n * @param event Will be mutated and enriched with req data\n * @param req Request object\n * @param options object containing flags to enable functionality\n * @hidden\n */\nexport function parseRequest(event: Event, req: ExpressRequest, options?: ParseRequestOptions): Event {\n  // eslint-disable-next-line no-param-reassign\n  options = {\n    ip: false,\n    request: true,\n    serverName: true,\n    transaction: true,\n    user: true,\n    version: true,\n    ...options,\n  };\n\n  if (options.version) {\n    event.contexts = {\n      ...event.contexts,\n      runtime: {\n        name: 'node',\n        version: global.process.version,\n      },\n    };\n  }\n\n  if (options.request) {\n    // if the option value is `true`, use the default set of keys by not passing anything to `extractNodeRequestData()`\n    const extractedRequestData = Array.isArray(options.request)\n      ? extractNodeRequestData(req, options.request)\n      : extractNodeRequestData(req);\n    event.request = {\n      ...event.request,\n      ...extractedRequestData,\n    };\n  }\n\n  if (options.serverName && !event.server_name) {\n    event.server_name = global.process.env.SENTRY_NAME || os.hostname();\n  }\n\n  if (options.user) {\n    const extractedUser = req.user && isPlainObject(req.user) ? extractUserData(req.user, options.user) : {};\n\n    if (Object.keys(extractedUser)) {\n      event.user = {\n        ...event.user,\n        ...extractedUser,\n      };\n    }\n  }\n\n  // client ip:\n  //   node: req.connection.remoteAddress\n  //   express, koa: req.ip\n  if (options.ip) {\n    const ip = req.ip || (req.connection && req.connection.remoteAddress);\n    if (ip) {\n      event.user = {\n        ...event.user,\n        ip_address: ip,\n      };\n    }\n  }\n\n  if (options.transaction && !event.transaction) {\n    event.transaction = extractTransaction(req, options.transaction);\n  }\n\n  return event;\n}\n\nexport type RequestHandlerOptions = ParseRequestOptions & {\n  flushTimeout?: number;\n};\n\n/**\n * Express compatible request handler.\n * @see Exposed as `Handlers.requestHandler`\n */\nexport function requestHandler(\n  options?: RequestHandlerOptions,\n): (req: http.IncomingMessage, res: http.ServerResponse, next: (error?: any) => void) => void {\n  return function sentryRequestMiddleware(\n    req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error?: any) => void,\n  ): void {\n    if (options && options.flushTimeout && options.flushTimeout > 0) {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      const _end = res.end;\n      res.end = function(chunk?: any | (() => void), encoding?: string | (() => void), cb?: () => void): void {\n        flush(options.flushTimeout)\n          .then(() => {\n            _end.call(this, chunk, encoding, cb);\n          })\n          .then(null, e => {\n            logger.error(e);\n          });\n      };\n    }\n    const local = domain.create();\n    local.add(req);\n    local.add(res);\n    local.on('error', next);\n    local.run(() => {\n      getCurrentHub().configureScope(scope =>\n        scope.addEventProcessor((event: Event) => parseRequest(event, req, options)),\n      );\n      next();\n    });\n  };\n}\n\n/** JSDoc */\ninterface MiddlewareError extends Error {\n  status?: number | string;\n  statusCode?: number | string;\n  status_code?: number | string;\n  output?: {\n    statusCode?: number | string;\n  };\n}\n\n/** JSDoc */\nfunction getStatusCodeFromResponse(error: MiddlewareError): number {\n  const statusCode = error.status || error.statusCode || error.status_code || (error.output && error.output.statusCode);\n  return statusCode ? parseInt(statusCode as string, 10) : 500;\n}\n\n/** Returns true if response code is internal server error */\nfunction defaultShouldHandleError(error: MiddlewareError): boolean {\n  const status = getStatusCodeFromResponse(error);\n  return status >= 500;\n}\n\n/**\n * Express compatible error handler.\n * @see Exposed as `Handlers.errorHandler`\n */\nexport function errorHandler(options?: {\n  /**\n   * Callback method deciding whether error should be captured and sent to Sentry\n   * @param error Captured middleware error\n   */\n  shouldHandleError?(error: MiddlewareError): boolean;\n}): (\n  error: MiddlewareError,\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (error: MiddlewareError) => void,\n) => void {\n  return function sentryErrorMiddleware(\n    error: MiddlewareError,\n    _req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error: MiddlewareError) => void,\n  ): void {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const shouldHandleError = (options && options.shouldHandleError) || defaultShouldHandleError;\n\n    if (shouldHandleError(error)) {\n      withScope(_scope => {\n        // For some reason we need to set the transaction on the scope again\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        const transaction = (res as any).__sentry_transaction as Span;\n        if (transaction && _scope.getSpan() === undefined) {\n          _scope.setSpan(transaction);\n        }\n        const eventId = captureException(error);\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        (res as any).sentry = eventId;\n        next(error);\n      });\n\n      return;\n    }\n\n    next(error);\n  };\n}\n\n/**\n * @hidden\n */\nexport function logAndExitProcess(error: Error): void {\n  // eslint-disable-next-line no-console\n  console.error(error && error.stack ? error.stack : error);\n\n  const client = getCurrentHub().getClient<NodeClient>();\n\n  if (client === undefined) {\n    logger.warn('No NodeClient was defined, we are exiting the process now.');\n    global.process.exit(1);\n    return;\n  }\n\n  const options = client.getOptions();\n  const timeout =\n    (options && options.shutdownTimeout && options.shutdownTimeout > 0 && options.shutdownTimeout) ||\n    DEFAULT_SHUTDOWN_TIMEOUT;\n  forget(\n    client.close(timeout).then((result: boolean) => {\n      if (!result) {\n        logger.warn('We reached the timeout for emptying the request buffer, still exiting now!');\n      }\n      global.process.exit(1);\n    }),\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}