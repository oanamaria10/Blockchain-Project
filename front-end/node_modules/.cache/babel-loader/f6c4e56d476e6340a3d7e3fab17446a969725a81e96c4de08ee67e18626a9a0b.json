{"ast":null,"code":"import * as API from '@ucanto/interface';\nimport { the } from './util.js';\nimport { isLink } from '@ucanto/core/link';\nimport { fail, Failure } from '@ucanto/core/result';\nexport { Failure, fail };\nexport class EscalatedCapability extends Failure {\n  /**\n   * @param {API.ParsedCapability} claimed\n   * @param {object} delegated\n   * @param {API.Failure} cause\n   */\n  constructor(claimed, delegated, cause) {\n    super();\n    this.claimed = claimed;\n    this.delegated = delegated;\n    this.cause = cause;\n    this.name = the('EscalatedCapability');\n  }\n  describe() {\n    return `Constraint violation: ${this.cause.message}`;\n  }\n}\n\n/**\n * @implements {API.DelegationError}\n */\nexport class DelegationError extends Failure {\n  /**\n   * @param {(API.InvalidCapability | API.EscalatedDelegation | API.DelegationError)[]} causes\n   * @param {object} context\n   */\n  constructor(causes, context) {\n    super();\n    this.name = the('InvalidClaim');\n    this.causes = causes;\n    this.context = context;\n  }\n  describe() {\n    return [`Can not derive ${this.context} from delegated capabilities:`, ...this.causes.map(cause => li(cause.message))].join('\\n');\n  }\n\n  /**\n   * @type {API.InvalidCapability | API.EscalatedDelegation | API.DelegationError}\n   */\n  get cause() {\n    /* c8 ignore next 9 */\n    if (this.causes.length !== 1) {\n      return this;\n    } else {\n      const [cause] = this.causes;\n      const value = cause.name === 'InvalidClaim' ? cause.cause : cause;\n      Object.defineProperties(this, {\n        cause: {\n          value\n        }\n      });\n      return value;\n    }\n  }\n}\n\n/**\n * @implements {API.SessionEscalation}\n */\nexport class SessionEscalation extends Failure {\n  /**\n   * @param {object} source\n   * @param {API.Delegation} source.delegation\n   * @param {API.Failure} source.cause\n   */\n  constructor({\n    delegation,\n    cause\n  }) {\n    super();\n    this.name = the('SessionEscalation');\n    this.delegation = delegation;\n    this.cause = cause;\n  }\n  describe() {\n    const issuer = this.delegation.issuer.did();\n    return [`Delegation ${this.delegation.cid} issued by ${issuer} has an invalid session`, li(this.cause.message)].join('\\n');\n  }\n}\n\n/**\n * @implements {API.InvalidSignature}\n */\nexport class InvalidSignature extends Failure {\n  /**\n   * @param {API.Delegation} delegation\n   * @param {API.Verifier} verifier\n   */\n  constructor(delegation, verifier) {\n    super();\n    this.name = the('InvalidSignature');\n    this.delegation = delegation;\n    this.verifier = verifier;\n  }\n  get issuer() {\n    return this.delegation.issuer;\n  }\n  get audience() {\n    return this.delegation.audience;\n  }\n  get key() {\n    return this.verifier.toDIDKey();\n  }\n  describe() {\n    const issuer = this.issuer.did();\n    const key = this.key;\n    return (issuer.startsWith('did:key') ? [`Proof ${this.delegation.cid} does not has a valid signature from ${key}`] : [`Proof ${this.delegation.cid} issued by ${issuer} does not has a valid signature from ${key}`, `  ℹ️ Probably issuer signed with a different key, which got rotated, invalidating delegations that were issued with prior keys`]).join('\\n');\n  }\n}\n\n/**\n * @implements {API.UnavailableProof}\n */\nexport class UnavailableProof extends Failure {\n  /**\n   * @param {API.UCAN.Link} link\n   * @param {Error} [cause]\n   */\n  constructor(link, cause) {\n    super();\n    this.name = the('UnavailableProof');\n    this.link = link;\n    this.cause = cause;\n  }\n  describe() {\n    return [`Linked proof '${this.link}' is not included and could not be resolved`, ...(this.cause ? [li(`Proof resolution failed with: ${this.cause.message}`)] : [])].join('\\n');\n  }\n}\nexport class DIDKeyResolutionError extends Failure {\n  /**\n   * @param {API.UCAN.DID} did\n   * @param {API.Failure} [cause]\n   */\n  constructor(did, cause) {\n    super();\n    this.name = the('DIDKeyResolutionError');\n    this.did = did;\n    this.cause = cause;\n  }\n  describe() {\n    return `Unable to resolve '${this.did}' key`;\n  }\n}\n\n/**\n * @implements {API.InvalidAudience}\n */\nexport class PrincipalAlignmentError extends Failure {\n  /**\n   * @param {API.UCAN.Principal} audience\n   * @param {API.Delegation} delegation\n   */\n  constructor(audience, delegation) {\n    super();\n    this.name = the('InvalidAudience');\n    this.audience = audience;\n    this.delegation = delegation;\n  }\n  describe() {\n    return `Delegation audience is '${this.delegation.audience.did()}' instead of '${this.audience.did()}'`;\n  }\n  toJSON() {\n    const {\n      name,\n      audience,\n      message,\n      stack\n    } = this;\n    return {\n      name,\n      audience: audience.did(),\n      delegation: {\n        audience: this.delegation.audience.did()\n      },\n      message,\n      stack\n    };\n  }\n}\n\n/**\n * @implements {API.MalformedCapability}\n */\nexport class MalformedCapability extends Failure {\n  /**\n   * @param {API.Capability} capability\n   * @param {API.Failure} cause\n   */\n  constructor(capability, cause) {\n    super();\n    this.name = the('MalformedCapability');\n    this.capability = capability;\n    this.cause = cause;\n  }\n  describe() {\n    return [`Encountered malformed '${this.capability.can}' capability: ${format(this.capability)}`, li(this.cause.message)].join('\\n');\n  }\n}\nexport class UnknownCapability extends Failure {\n  /**\n   * @param {API.Capability} capability\n   */\n  constructor(capability) {\n    super();\n    this.name = the('UnknownCapability');\n    this.capability = capability;\n  }\n  /* c8 ignore next 3 */\n  describe() {\n    return `Encountered unknown capability: ${format(this.capability)}`;\n  }\n}\nexport class Expired extends Failure {\n  /**\n   * @param {API.Delegation & { expiration: number }} delegation\n   */\n  constructor(delegation) {\n    super();\n    this.name = the('Expired');\n    this.delegation = delegation;\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} has expired on ${new Date(this.delegation.expiration * 1000)}`;\n  }\n  get expiredAt() {\n    return this.delegation.expiration;\n  }\n  toJSON() {\n    const {\n      name,\n      expiredAt,\n      message,\n      stack\n    } = this;\n    return {\n      name,\n      message,\n      expiredAt,\n      stack\n    };\n  }\n}\n\n/**\n * @implements {API.Revoked}\n */\nexport class Revoked extends Failure {\n  /**\n   * @param {API.Delegation} delegation\n   */\n  constructor(delegation) {\n    super();\n    this.name = the('Revoked');\n    this.delegation = delegation;\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} has been revoked`;\n  }\n  toJSON() {\n    const {\n      name,\n      message,\n      stack\n    } = this;\n    return {\n      name,\n      message,\n      stack\n    };\n  }\n}\nexport class NotValidBefore extends Failure {\n  /**\n   * @param {API.Delegation & { notBefore: number }} delegation\n   */\n  constructor(delegation) {\n    super();\n    this.name = the('NotValidBefore');\n    this.delegation = delegation;\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} is not valid before ${new Date(this.delegation.notBefore * 1000)}`;\n  }\n  get validAt() {\n    return this.delegation.notBefore;\n  }\n  toJSON() {\n    const {\n      name,\n      validAt,\n      message,\n      stack\n    } = this;\n    return {\n      name,\n      message,\n      validAt,\n      stack\n    };\n  }\n}\n\n/**\n * @implements {API.Unauthorized}\n */\n\nexport class Unauthorized extends Failure {\n  /**\n   * @param {{\n   * capability: API.CapabilityParser\n   * delegationErrors: API.DelegationError[]\n   * unknownCapabilities: API.Capability[]\n   * invalidProofs: API.InvalidProof[]\n   * failedProofs: API.InvalidClaim[]\n   * }} cause\n   */\n  constructor({\n    capability,\n    delegationErrors,\n    unknownCapabilities,\n    invalidProofs,\n    failedProofs\n  }) {\n    super();\n    /** @type {\"Unauthorized\"} */\n    this.name = 'Unauthorized';\n    this.capability = capability;\n    this.delegationErrors = delegationErrors;\n    this.unknownCapabilities = unknownCapabilities;\n    this.invalidProofs = invalidProofs;\n    this.failedProofs = failedProofs;\n  }\n  describe() {\n    const errors = [...this.failedProofs.map(error => li(error.message)), ...this.delegationErrors.map(error => li(error.message)), ...this.invalidProofs.map(error => li(error.message))];\n    const unknown = this.unknownCapabilities.map(c => li(JSON.stringify(c)));\n    return [`Claim ${this.capability} is not authorized`, ...(errors.length > 0 ? errors : [li(`No matching delegated capability found`)]), ...(unknown.length > 0 ? [li(`Encountered unknown capabilities\\n${unknown.join('\\n')}`)] : [])].join('\\n');\n  }\n}\n\n/**\n * @param {unknown} capability\n * @param {string|number} [space]\n */\n\nconst format = (capability, space) => JSON.stringify(capability, (_key, value) => {\n  /* c8 ignore next 2 */\n  if (isLink(value)) {\n    return value.toString();\n  } else {\n    return value;\n  }\n}, space);\n\n/**\n * @param {string} message\n */\nexport const indent = (message, indent = '  ') => `${indent}${message.split('\\n').join(`\\n${indent}`)}`;\n\n/**\n * @param {string} message\n */\nexport const li = message => indent(`- ${message}`);","map":{"version":3,"names":["API","the","isLink","fail","Failure","EscalatedCapability","constructor","claimed","delegated","cause","name","describe","message","DelegationError","causes","context","map","li","join","length","value","Object","defineProperties","SessionEscalation","delegation","issuer","did","cid","InvalidSignature","verifier","audience","key","toDIDKey","startsWith","UnavailableProof","link","DIDKeyResolutionError","PrincipalAlignmentError","toJSON","stack","MalformedCapability","capability","can","format","UnknownCapability","Expired","Date","expiration","expiredAt","Revoked","NotValidBefore","notBefore","validAt","Unauthorized","delegationErrors","unknownCapabilities","invalidProofs","failedProofs","errors","error","unknown","c","JSON","stringify","space","_key","toString","indent","split"],"sources":["C:/FACULTATE/Proiect/node_modules/@ucanto/validator/src/error.js"],"sourcesContent":["import * as API from '@ucanto/interface'\nimport { the } from './util.js'\nimport { isLink } from '@ucanto/core/link'\nimport { fail, Failure } from '@ucanto/core/result'\n\nexport { Failure, fail }\n\nexport class EscalatedCapability extends Failure {\n  /**\n   * @param {API.ParsedCapability} claimed\n   * @param {object} delegated\n   * @param {API.Failure} cause\n   */\n  constructor(claimed, delegated, cause) {\n    super()\n    this.claimed = claimed\n    this.delegated = delegated\n    this.cause = cause\n    this.name = the('EscalatedCapability')\n  }\n  describe() {\n    return `Constraint violation: ${this.cause.message}`\n  }\n}\n\n/**\n * @implements {API.DelegationError}\n */\nexport class DelegationError extends Failure {\n  /**\n   * @param {(API.InvalidCapability | API.EscalatedDelegation | API.DelegationError)[]} causes\n   * @param {object} context\n   */\n  constructor(causes, context) {\n    super()\n    this.name = the('InvalidClaim')\n    this.causes = causes\n    this.context = context\n  }\n  describe() {\n    return [\n      `Can not derive ${this.context} from delegated capabilities:`,\n      ...this.causes.map(cause => li(cause.message)),\n    ].join('\\n')\n  }\n\n  /**\n   * @type {API.InvalidCapability | API.EscalatedDelegation | API.DelegationError}\n   */\n  get cause() {\n    /* c8 ignore next 9 */\n    if (this.causes.length !== 1) {\n      return this\n    } else {\n      const [cause] = this.causes\n      const value = cause.name === 'InvalidClaim' ? cause.cause : cause\n      Object.defineProperties(this, { cause: { value } })\n      return value\n    }\n  }\n}\n\n/**\n * @implements {API.SessionEscalation}\n */\nexport class SessionEscalation extends Failure {\n  /**\n   * @param {object} source\n   * @param {API.Delegation} source.delegation\n   * @param {API.Failure} source.cause\n   */\n  constructor({ delegation, cause }) {\n    super()\n    this.name = the('SessionEscalation')\n    this.delegation = delegation\n    this.cause = cause\n  }\n  describe() {\n    const issuer = this.delegation.issuer.did()\n    return [\n      `Delegation ${this.delegation.cid} issued by ${issuer} has an invalid session`,\n      li(this.cause.message),\n    ].join('\\n')\n  }\n}\n\n/**\n * @implements {API.InvalidSignature}\n */\nexport class InvalidSignature extends Failure {\n  /**\n   * @param {API.Delegation} delegation\n   * @param {API.Verifier} verifier\n   */\n  constructor(delegation, verifier) {\n    super()\n    this.name = the('InvalidSignature')\n    this.delegation = delegation\n    this.verifier = verifier\n  }\n  get issuer() {\n    return this.delegation.issuer\n  }\n  get audience() {\n    return this.delegation.audience\n  }\n  get key() {\n    return this.verifier.toDIDKey()\n  }\n  describe() {\n    const issuer = this.issuer.did()\n    const key = this.key\n    return (\n      issuer.startsWith('did:key')\n        ? [\n            `Proof ${this.delegation.cid} does not has a valid signature from ${key}`,\n          ]\n        : [\n            `Proof ${this.delegation.cid} issued by ${issuer} does not has a valid signature from ${key}`,\n            `  ℹ️ Probably issuer signed with a different key, which got rotated, invalidating delegations that were issued with prior keys`,\n          ]\n    ).join('\\n')\n  }\n}\n\n/**\n * @implements {API.UnavailableProof}\n */\nexport class UnavailableProof extends Failure {\n  /**\n   * @param {API.UCAN.Link} link\n   * @param {Error} [cause]\n   */\n  constructor(link, cause) {\n    super()\n    this.name = the('UnavailableProof')\n    this.link = link\n    this.cause = cause\n  }\n  describe() {\n    return [\n      `Linked proof '${this.link}' is not included and could not be resolved`,\n      ...(this.cause\n        ? [li(`Proof resolution failed with: ${this.cause.message}`)]\n        : []),\n    ].join('\\n')\n  }\n}\n\nexport class DIDKeyResolutionError extends Failure {\n  /**\n   * @param {API.UCAN.DID} did\n   * @param {API.Failure} [cause]\n   */\n  constructor(did, cause) {\n    super()\n    this.name = the('DIDKeyResolutionError')\n    this.did = did\n    this.cause = cause\n  }\n  describe() {\n    return `Unable to resolve '${this.did}' key`\n  }\n}\n\n/**\n * @implements {API.InvalidAudience}\n */\nexport class PrincipalAlignmentError extends Failure {\n  /**\n   * @param {API.UCAN.Principal} audience\n   * @param {API.Delegation} delegation\n   */\n  constructor(audience, delegation) {\n    super()\n    this.name = the('InvalidAudience')\n    this.audience = audience\n    this.delegation = delegation\n  }\n  describe() {\n    return `Delegation audience is '${this.delegation.audience.did()}' instead of '${this.audience.did()}'`\n  }\n  toJSON() {\n    const { name, audience, message, stack } = this\n    return {\n      name,\n      audience: audience.did(),\n      delegation: { audience: this.delegation.audience.did() },\n      message,\n      stack,\n    }\n  }\n}\n\n/**\n * @implements {API.MalformedCapability}\n */\nexport class MalformedCapability extends Failure {\n  /**\n   * @param {API.Capability} capability\n   * @param {API.Failure} cause\n   */\n  constructor(capability, cause) {\n    super()\n    this.name = the('MalformedCapability')\n    this.capability = capability\n    this.cause = cause\n  }\n  describe() {\n    return [\n      `Encountered malformed '${this.capability.can}' capability: ${format(\n        this.capability\n      )}`,\n      li(this.cause.message),\n    ].join('\\n')\n  }\n}\n\nexport class UnknownCapability extends Failure {\n  /**\n   * @param {API.Capability} capability\n   */\n  constructor(capability) {\n    super()\n    this.name = the('UnknownCapability')\n    this.capability = capability\n  }\n  /* c8 ignore next 3 */\n  describe() {\n    return `Encountered unknown capability: ${format(this.capability)}`\n  }\n}\n\nexport class Expired extends Failure {\n  /**\n   * @param {API.Delegation & { expiration: number }} delegation\n   */\n  constructor(delegation) {\n    super()\n    this.name = the('Expired')\n    this.delegation = delegation\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} has expired on ${new Date(\n      this.delegation.expiration * 1000\n    )}`\n  }\n  get expiredAt() {\n    return this.delegation.expiration\n  }\n  toJSON() {\n    const { name, expiredAt, message, stack } = this\n    return {\n      name,\n      message,\n      expiredAt,\n      stack,\n    }\n  }\n}\n\n/**\n * @implements {API.Revoked}\n */\nexport class Revoked extends Failure {\n  /**\n   * @param {API.Delegation} delegation\n   */\n  constructor(delegation) {\n    super()\n    this.name = the('Revoked')\n    this.delegation = delegation\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} has been revoked`\n  }\n  toJSON() {\n    const { name, message, stack } = this\n    return {\n      name,\n      message,\n      stack,\n    }\n  }\n}\n\nexport class NotValidBefore extends Failure {\n  /**\n   * @param {API.Delegation & { notBefore: number }} delegation\n   */\n  constructor(delegation) {\n    super()\n    this.name = the('NotValidBefore')\n    this.delegation = delegation\n  }\n  describe() {\n    return `Proof ${this.delegation.cid} is not valid before ${new Date(\n      this.delegation.notBefore * 1000\n    )}`\n  }\n  get validAt() {\n    return this.delegation.notBefore\n  }\n  toJSON() {\n    const { name, validAt, message, stack } = this\n    return {\n      name,\n      message,\n      validAt,\n      stack,\n    }\n  }\n}\n\n/**\n * @implements {API.Unauthorized}\n */\n\nexport class Unauthorized extends Failure {\n  /**\n   * @param {{\n   * capability: API.CapabilityParser\n   * delegationErrors: API.DelegationError[]\n   * unknownCapabilities: API.Capability[]\n   * invalidProofs: API.InvalidProof[]\n   * failedProofs: API.InvalidClaim[]\n   * }} cause\n   */\n  constructor({\n    capability,\n    delegationErrors,\n    unknownCapabilities,\n    invalidProofs,\n    failedProofs,\n  }) {\n    super()\n    /** @type {\"Unauthorized\"} */\n    this.name = 'Unauthorized'\n    this.capability = capability\n    this.delegationErrors = delegationErrors\n    this.unknownCapabilities = unknownCapabilities\n    this.invalidProofs = invalidProofs\n    this.failedProofs = failedProofs\n  }\n\n  describe() {\n    const errors = [\n      ...this.failedProofs.map(error => li(error.message)),\n      ...this.delegationErrors.map(error => li(error.message)),\n      ...this.invalidProofs.map(error => li(error.message)),\n    ]\n\n    const unknown = this.unknownCapabilities.map(c => li(JSON.stringify(c)))\n\n    return [\n      `Claim ${this.capability} is not authorized`,\n      ...(errors.length > 0\n        ? errors\n        : [li(`No matching delegated capability found`)]),\n      ...(unknown.length > 0\n        ? [li(`Encountered unknown capabilities\\n${unknown.join('\\n')}`)]\n        : []),\n    ].join('\\n')\n  }\n}\n\n/**\n * @param {unknown} capability\n * @param {string|number} [space]\n */\n\nconst format = (capability, space) =>\n  JSON.stringify(\n    capability,\n    (_key, value) => {\n      /* c8 ignore next 2 */\n      if (isLink(value)) {\n        return value.toString()\n      } else {\n        return value\n      }\n    },\n    space\n  )\n\n/**\n * @param {string} message\n */\nexport const indent = (message, indent = '  ') =>\n  `${indent}${message.split('\\n').join(`\\n${indent}`)}`\n\n/**\n * @param {string} message\n */\nexport const li = message => indent(`- ${message}`)\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}