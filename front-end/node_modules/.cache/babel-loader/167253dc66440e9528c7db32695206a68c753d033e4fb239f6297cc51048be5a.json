{"ast":null,"code":"'use strict';\n\nconst {\n  promisify\n} = require('util');\nconst Pool = require('../pool');\nconst {\n  buildMockDispatch\n} = require('./mock-utils');\nconst {\n  kDispatches,\n  kMockAgent,\n  kClose,\n  kOriginalClose,\n  kOrigin,\n  kOriginalDispatch,\n  kConnected\n} = require('./mock-symbols');\nconst {\n  MockInterceptor\n} = require('./mock-interceptor');\nconst Symbols = require('../core/symbols');\nconst {\n  InvalidArgumentError\n} = require('../core/errors');\n\n/**\n * MockPool provides an API that extends the Pool to influence the mockDispatches.\n */\nclass MockPool extends Pool {\n  constructor(origin, opts) {\n    super(origin, opts);\n    if (!opts || !opts.agent || typeof opts.agent.dispatch !== 'function') {\n      throw new InvalidArgumentError('Argument opts.agent must implement Agent');\n    }\n    this[kMockAgent] = opts.agent;\n    this[kOrigin] = origin;\n    this[kDispatches] = [];\n    this[kConnected] = 1;\n    this[kOriginalDispatch] = this.dispatch;\n    this[kOriginalClose] = this.close.bind(this);\n    this.dispatch = buildMockDispatch.call(this);\n    this.close = this[kClose];\n  }\n  get [Symbols.kConnected]() {\n    return this[kConnected];\n  }\n\n  /**\n   * Sets up the base interceptor for mocking replies from undici.\n   */\n  intercept(opts) {\n    return new MockInterceptor(opts, this[kDispatches]);\n  }\n  async [kClose]() {\n    await promisify(this[kOriginalClose])();\n    this[kConnected] = 0;\n    this[kMockAgent][Symbols.kClients].delete(this[kOrigin]);\n  }\n}\nmodule.exports = MockPool;","map":{"version":3,"names":["promisify","require","Pool","buildMockDispatch","kDispatches","kMockAgent","kClose","kOriginalClose","kOrigin","kOriginalDispatch","kConnected","MockInterceptor","Symbols","InvalidArgumentError","MockPool","constructor","origin","opts","agent","dispatch","close","bind","call","intercept","kClients","delete","module","exports"],"sources":["C:/Users/rares/Desktop/Blockchain/Proiect/node_modules/undici/lib/mock/mock-pool.js"],"sourcesContent":["'use strict'\n\nconst { promisify } = require('util')\nconst Pool = require('../pool')\nconst { buildMockDispatch } = require('./mock-utils')\nconst {\n  kDispatches,\n  kMockAgent,\n  kClose,\n  kOriginalClose,\n  kOrigin,\n  kOriginalDispatch,\n  kConnected\n} = require('./mock-symbols')\nconst { MockInterceptor } = require('./mock-interceptor')\nconst Symbols = require('../core/symbols')\nconst { InvalidArgumentError } = require('../core/errors')\n\n/**\n * MockPool provides an API that extends the Pool to influence the mockDispatches.\n */\nclass MockPool extends Pool {\n  constructor (origin, opts) {\n    super(origin, opts)\n\n    if (!opts || !opts.agent || typeof opts.agent.dispatch !== 'function') {\n      throw new InvalidArgumentError('Argument opts.agent must implement Agent')\n    }\n\n    this[kMockAgent] = opts.agent\n    this[kOrigin] = origin\n    this[kDispatches] = []\n    this[kConnected] = 1\n    this[kOriginalDispatch] = this.dispatch\n    this[kOriginalClose] = this.close.bind(this)\n\n    this.dispatch = buildMockDispatch.call(this)\n    this.close = this[kClose]\n  }\n\n  get [Symbols.kConnected] () {\n    return this[kConnected]\n  }\n\n  /**\n   * Sets up the base interceptor for mocking replies from undici.\n   */\n  intercept (opts) {\n    return new MockInterceptor(opts, this[kDispatches])\n  }\n\n  async [kClose] () {\n    await promisify(this[kOriginalClose])()\n    this[kConnected] = 0\n    this[kMockAgent][Symbols.kClients].delete(this[kOrigin])\n  }\n}\n\nmodule.exports = MockPool\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAM;EAAEA;AAAU,CAAC,GAAGC,OAAO,CAAC,MAAM,CAAC;AACrC,MAAMC,IAAI,GAAGD,OAAO,CAAC,SAAS,CAAC;AAC/B,MAAM;EAAEE;AAAkB,CAAC,GAAGF,OAAO,CAAC,cAAc,CAAC;AACrD,MAAM;EACJG,WAAW;EACXC,UAAU;EACVC,MAAM;EACNC,cAAc;EACdC,OAAO;EACPC,iBAAiB;EACjBC;AACF,CAAC,GAAGT,OAAO,CAAC,gBAAgB,CAAC;AAC7B,MAAM;EAAEU;AAAgB,CAAC,GAAGV,OAAO,CAAC,oBAAoB,CAAC;AACzD,MAAMW,OAAO,GAAGX,OAAO,CAAC,iBAAiB,CAAC;AAC1C,MAAM;EAAEY;AAAqB,CAAC,GAAGZ,OAAO,CAAC,gBAAgB,CAAC;;AAE1D;AACA;AACA;AACA,MAAMa,QAAQ,SAASZ,IAAI,CAAC;EAC1Ba,WAAWA,CAAEC,MAAM,EAAEC,IAAI,EAAE;IACzB,KAAK,CAACD,MAAM,EAAEC,IAAI,CAAC;IAEnB,IAAI,CAACA,IAAI,IAAI,CAACA,IAAI,CAACC,KAAK,IAAI,OAAOD,IAAI,CAACC,KAAK,CAACC,QAAQ,KAAK,UAAU,EAAE;MACrE,MAAM,IAAIN,oBAAoB,CAAC,0CAA0C,CAAC;IAC5E;IAEA,IAAI,CAACR,UAAU,CAAC,GAAGY,IAAI,CAACC,KAAK;IAC7B,IAAI,CAACV,OAAO,CAAC,GAAGQ,MAAM;IACtB,IAAI,CAACZ,WAAW,CAAC,GAAG,EAAE;IACtB,IAAI,CAACM,UAAU,CAAC,GAAG,CAAC;IACpB,IAAI,CAACD,iBAAiB,CAAC,GAAG,IAAI,CAACU,QAAQ;IACvC,IAAI,CAACZ,cAAc,CAAC,GAAG,IAAI,CAACa,KAAK,CAACC,IAAI,CAAC,IAAI,CAAC;IAE5C,IAAI,CAACF,QAAQ,GAAGhB,iBAAiB,CAACmB,IAAI,CAAC,IAAI,CAAC;IAC5C,IAAI,CAACF,KAAK,GAAG,IAAI,CAACd,MAAM,CAAC;EAC3B;EAEA,KAAKM,OAAO,CAACF,UAAU,IAAK;IAC1B,OAAO,IAAI,CAACA,UAAU,CAAC;EACzB;;EAEA;AACF;AACA;EACEa,SAASA,CAAEN,IAAI,EAAE;IACf,OAAO,IAAIN,eAAe,CAACM,IAAI,EAAE,IAAI,CAACb,WAAW,CAAC,CAAC;EACrD;EAEA,OAAOE,MAAM,IAAK;IAChB,MAAMN,SAAS,CAAC,IAAI,CAACO,cAAc,CAAC,CAAC,CAAC,CAAC;IACvC,IAAI,CAACG,UAAU,CAAC,GAAG,CAAC;IACpB,IAAI,CAACL,UAAU,CAAC,CAACO,OAAO,CAACY,QAAQ,CAAC,CAACC,MAAM,CAAC,IAAI,CAACjB,OAAO,CAAC,CAAC;EAC1D;AACF;AAEAkB,MAAM,CAACC,OAAO,GAAGb,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}