{"ast":null,"code":"/**\n * The main entry point for the `@web3-storage/w3up-client` package.\n *\n * Use the static {@link create} function to create a new {@link Client} object.\n *\n * @module\n */\nimport { AgentData } from '@web3-storage/access/agent';\nimport { StoreIndexedDB } from '@web3-storage/access/stores/store-indexeddb';\nimport { generate } from '@ucanto/principal/rsa';\nimport { Client } from './client.js';\nimport * as _Result from './result.js';\nexport { _Result as Result };\nimport * as _Account from './account.js';\nexport { _Account as Account };\nexport * from './ability.js';\nexport { authorizeContentServe } from './client.js';\n/**\n * Create a new w3up client.\n *\n * If no backing store is passed one will be created that is appropriate for\n * the environment.\n *\n * If the backing store is empty, a new signing key will be generated and\n * persisted to the store. In the browser an unextractable RSA key will be\n * generated by default. In other environments an Ed25519 key is generated.\n *\n * If the backing store already has data stored, it will be loaded and used.\n *\n * @type {import('./types.js').ClientFactory}\n */\nexport async function create(options = {}) {\n  const store = options.store ?? new StoreIndexedDB('w3up-client');\n  const raw = await store.load();\n  if (raw) {\n    const data = AgentData.fromExport(raw, {\n      store\n    });\n    if (options.principal && data.principal.did() !== options.principal.did()) {\n      throw new Error(`store cannot be used with ${options.principal.did()}, stored principal and passed principal must match`);\n    }\n    return new Client(data, options);\n  }\n  const principal = options.principal ?? (await generate());\n  const data = await AgentData.create({\n    principal\n  }, {\n    store\n  });\n  return new Client(data, options);\n}\nexport { Client };","map":{"version":3,"names":["AgentData","StoreIndexedDB","generate","Client","_Result","Result","_Account","Account","authorizeContentServe","create","options","store","raw","load","data","fromExport","principal","did","Error"],"sources":["../../src/index.js"],"sourcesContent":[null],"mappings":"AAAA;;;;;;;AAOA,SAASA,SAAS,QAAQ,4BAA4B;AACtD,SAASC,cAAc,QAAQ,6CAA6C;AAC5E,SAASC,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,MAAM,QAAQ,aAAa;AAAA,YAAAC,OAAA,MACZ,aAAa;AAAA,SAAAA,OAAA,IAAzBC,MAAM;AAAA,YAAAC,QAAA,MACO,cAAc;AAAA,SAAAA,QAAA,IAA3BC,OAAO;AACnB,cAAc,cAAc;AAC5B,SAASC,qBAAqB,QAAQ,aAAa;AAEnD;;;;;;;;;;;;;;AAcA,OAAO,eAAeC,MAAMA,CAACC,OAAO,GAAG,EAAE;EACvC,MAAMC,KAAK,GAAGD,OAAO,CAACC,KAAK,IAAI,IAAIV,cAAc,CAAC,aAAa,CAAC;EAChE,MAAMW,GAAG,GAAG,MAAMD,KAAK,CAACE,IAAI,EAAE;EAC9B,IAAID,GAAG,EAAE;IACP,MAAME,IAAI,GAAGd,SAAS,CAACe,UAAU,CAACH,GAAG,EAAE;MAAED;IAAK,CAAE,CAAC;IACjD,IAAID,OAAO,CAACM,SAAS,IAAIF,IAAI,CAACE,SAAS,CAACC,GAAG,EAAE,KAAKP,OAAO,CAACM,SAAS,CAACC,GAAG,EAAE,EAAE;MACzE,MAAM,IAAIC,KAAK,CACb,6BAA6BR,OAAO,CAACM,SAAS,CAACC,GAAG,EAAE,oDAAoD,CACzG;;IAEH,OAAO,IAAId,MAAM,CAACW,IAAI,EAAEJ,OAAO,CAAC;;EAElC,MAAMM,SAAS,GAAGN,OAAO,CAACM,SAAS,KAAK,MAAMd,QAAQ,EAAE,CAAC;EACzD,MAAMY,IAAI,GAAG,MAAMd,SAAS,CAACS,MAAM,CAAC;IAAEO;EAAS,CAAE,EAAE;IAAEL;EAAK,CAAE,CAAC;EAC7D,OAAO,IAAIR,MAAM,CAACW,IAAI,EAAEJ,OAAO,CAAC;AAClC;AAEA,SAASP,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}